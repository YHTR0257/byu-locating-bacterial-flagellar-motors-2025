# Abstract

- YOLO以外のアプローチを考える
- YOLOのハイパーパラメータチューニングを行う

# Have done
- Hyperparameter tuning
    - 1 epochでかなりばらつきが出てしまっている。これは改善が必要かもしれない
- Gaussian ball形式でのモデル作成

# What I learn

### YOLOについて
- 自動でData augmentationをやってくれる
    - albumantationと呼ばれるパッケージを用いている

### Gaussian ball形式のlabelingが効果的
- これはYOLOで用いることのできないアプローチ
- 3D-CNNや2D-CNNを用いて実装することが必要になる
    - これは実装が大変そう、ただ効果的なアプローチではある
    - 用いそうなモデル：回帰モデルで、性能が高いもの
        - Simple 2D-CNN -> nb010
        - U-Net -> nb011
        - Encoder + Resnet + Decoder -> nb 012

### コード設計
- train
    - 2D-CNN系統を用いて学習を行う
    - 学習サイズは960*960
    - 予想モデルには上の3種類を用いる
    - Labelingは0~256のグレースケールマスク
- predict
    - 全体を一括でスキャンする
        - 実装が楽でわかりやすい
    - もしくはcropしてスキャン
        - こっちの方が解像度が保てるため理想的。ただし、推論時間が少しかかってしまうこと・データセットの生成に時間がかかってしまうことが難点。

---
設計要素

|パラメータ | 文字 | 目的・効果 |
|------|------|------|
|中心 |$(x, y, z)$ | ガウス分布の中心 |
|標準偏差 |$ \sigma or (σx, σy, σz)$ | 広がり（ぼやけ具合） |
|球の半径 or 有効範囲| r | ガウス計算の打ち切り|
|最大値（スケーリング）| peak_max | ガウスのピークの値 |
|マスクサイズ | image_size | 計算領域のサイズ指定 |
|異方性対応 |  | $z$軸スケール補正などに有効 |
|多数点への対応 |  | ヒートマップの合成方法 |
|分布のタイプ | kernel_function | ガウス以外の核関数利用も可 |
|正規化の有無 | norm | 出力スケール統一性の確保 |
---
z軸の扱いをどうするかが焦点。trainにはvoxel spacingが記載されているため、これを用いることが予想される。

### そもそもGaussian Ballとは

まず「3D Gaussian Ball」ですが、これは**3次元ガウス分布に従う球状のラベル表現**を意味します。

#### ● 背景：
このKaggleコンペは、電子顕微鏡（ET）画像から**バクテリアの鞭毛モーター**の位置を特定することが目的です。これらは小さな点状の構造で、3D画像の中に存在しています。

#### ● 通常のラベル方法との違い：
多くの検出タスクでは、ある物体の中心に対して「(x, y, z)座標だけで点としてラベルを付ける」か、「バウンディングボックスを使う」方法が一般的ですが…

ここで議論されている「3D Gaussian Ball」は、以下のようなラベル方法です：

| 特徴 | 内容 |
|------|------|
| 形状 | 3D空間内に分布する「ぼやけた球」 |
| 中心 | ラベル付け対象の正確な位置（例：モーターの中心） |
| 値の分布 | 中心が最大値で、そこからガウス的に値が減衰していく（＝中心から離れるほどラベルの信頼度が低くなる） |
| 目的 | より滑らかな監督信号を使うことで、モデルが「中心以外も参考にして位置を特定できる」ようになる |

このようなガウシアン球体（Gaussian ball）は、Heatmap形式の学習でよく使われます（例：キーポイント検出など）。

---

### 💡 **2. Tomの「labeling」の意味**

Tomさん（@ThomasLynn）は、discussion中で**独自のラベル生成方法に取り組んでいる**と述べています。

#### ● 「labeling」とは何か？

ここでの「labeling」は、Kaggleの提供するラベル（座標情報）を**3Dボリューム上の教師信号（ラベルマップ）として変換する処理**のことを指しています。

#### ● Tomさんがやっていること：
Tomさんは、以下のようなアプローチを試みています：

- 提供された(x, y, z)座標をもとに、
- モーター位置に3Dガウス関数を置き、
- モーターの「ラベルマップ（＝教師データ）」を作成している

つまり、単なる点ラベル（数値）ではなく、**3D空間内のラベルボリューム（＝ラベルテンソル）を作成して学習に使いたい**ということです。

---

### 🧠 要点まとめ

| 用語 | 意味 |
|------|------|
| **3D Gaussian Ball** | 位置ラベルの代わりに、モーター中心にガウス分布を持つ3Dラベル（ヒートマップ）を配置すること。 |
| **Tomのlabeling** | 点情報を元に、学習用の3Dラベルマップを構成するプロセス。Heatmap形式に変換してモデル学習を強化しようとしている。 |

---


関係ないもの
- RT-DETR https://www.issoh.co.jp/tech/details/3117/
# Problem
# Idea
# Next